function getGreenToRed(e){return g=50>e?255:Math.floor(255-255*(2*e-100)/100),r=e>50?255:Math.floor(2*e*255/100),"rgb("+r+","+g+",0)"}var render_bar_charts=function(){$(".chart").each(function(e,t){var r=$(t),o=[parseInt(r.data("dataHours"))],n=[parseInt(r.data("dataHoursUsed"))],a=parseFloat(r.data("bar-width"))||15,c=parseFloat(r.data("bar-space"))||.5,s=r.outerHeight(),i=d3.scale.linear().domain([0,o]).range([0,150]);d3.scale.linear().domain([0,s]).range([0,o]);d3.select(t).append("g").selectAll(".bar-hours").data(o).enter().append("rect").attr("class","bar-hours").attr("width",a).attr("x",function(e,t){return a*t+c*t}).attr("y",s).attr("height",s).attr("y",0),d3.select(t).selectAll("g").selectAll(".bar-used").data(n).enter().append("rect").attr("class","bar-used").attr("width",a).attr("x",function(e,t){return a*t+c*t}).attr("y",s).attr("height",0).transition().delay(function(e,t){return 100*t}).attr("y",function(e,t){return s-i(e)}).attr("height",function(e){return i(e)}).attr("fill",function(e,t){return getGreenToRed(e/o[t]*100)})})};!function(e,t,r){"use strict";var o=t.module("pressurizeApp",["ngRoute"]);o.config(["$routeProvider",function(e){e.when("/projects/",{templateUrl:"partials/projects-list.html",controller:"ProjectsListController"}).when("/projects/create/",{templateUrl:"partials/projects-create.html",controller:"ProjectCreateController"}).otherwise({redirectTo:"/projects/"})}]),o.service("sharedProperties",function(){var e=null!==localStorage.getItem("projects")?JSON.parse(localStorage.getItem("projects")):[],t=null!==localStorage.getItem("time_records")?JSON.parse(localStorage.getItem("time_records")):[];return{getProjects:function(){return e=_.filter(e,function(e){return"undefined"!=typeof e.name?e:void 0})},setProjects:function(t){e.push(t),e=_.filter(e,function(e){return"undefined"!=typeof e.name?e:void 0});var r=JSON.stringify(e,function(e,t){return"$$hashKey"==e?void 0:t});localStorage.setItem("projects",r)},updateProjects:function(e){this.setProjects(e)},getTimeRecords:function(){return t=_.filter(t,function(e){return"undefined"!=typeof e.name?e:void 0})},setTimeRecords:function(e){t.push(e),t=_.filter(t,function(e){return"undefined"!=typeof e.hours?e:void 0});var r=JSON.stringify(t,function(e,t){return"$$hashKey"==e?void 0:t});localStorage.setItem("time_records",r)}}}),o.controller("ProjectsListController",["$scope","$http","sharedProperties",function(t,r,o){t.projects=o.getProjects(),t.init=function(){var t=setInterval(function(){e(".chart").length>0&&(render_bar_charts(),clearInterval(t))},100)}}]),o.controller("TimeRecordsController",["$scope","$http","sharedProperties","$compile",function(e,t,r,o){e.time_record={},e.timeRecordSubmit=function(t){t||alert("please fill out required fields");var o=new TimeRecord(e.time_record),n=_.findWhere(r.getProjects(),{$$hashKey:e.time_record.project_number});n.total_used=parseInt(n.total_used)+parseInt(o.hours);var a=r.getProjects();a=_.map(function(e){return e.$$hashKey==o.project_number?e:void 0}),r.updateProjects(a),r.setTimeRecords({hours:o.hours,comments:o.comments,project_number:o.project_number})}}]),o.controller("ProjectCreateController",["$scope","$http","sharedProperties",function(e,t,o){e.project={},e.submitForm=function(t){t||alert("please fill out all fields correctly"),o.setProjects({name:e.project.name,description:e.project.description,dev_hours:e.project.dev_hours,total_used:e.project.total_used}),alert("project created!"),r.location="/#/projects"}}])}(jQuery,angular,window),RowEditor=function(e,t){"use strict";var r=function(e){this.$object=e};return r.prototype.init=function(){this.addEvents($obj)},r}(jQuery,window),TimeRecord=function(e,t){"use strict";var r=function(t){"undefined"!=typeof t.hours&&(t.hours=parseInt(t.hours),this.hours=t.hours,this.project_number=t.project_number,this.comments=e.trim(t.comments))};return r.prototype={hours:0,comments:"",project_number:null},r}(jQuery,window);