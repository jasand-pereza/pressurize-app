var App=function(t,e){"use strict";function r(t){var e=50>t?255:Math.floor(255-255*(2*t-100)/100),r=t>50?255:Math.floor(2*t*255/100);return"rgb("+r+","+e+",0)"}var o={};return o.renderBarCharts=function(){t(".chart").each(function(e,o){var n=t(o);n.contents().remove();var a=[parseInt(n.data("dataHours"))],c=[parseInt(n.data("dataHoursUsed"))],s=parseFloat(n.data("bar-width"))||15,i=parseFloat(n.data("bar-space"))||.5,u=n.outerHeight(),l=d3.scale.linear().domain([0,a]).range([0,150]);d3.scale.linear().domain([0,u]).range([0,a]);d3.select(o).append("g").selectAll(".bar-hours").data(a).enter().append("rect").attr("class","bar-hours").attr("width",s).attr("x",function(t,e){return s*e+i*e}).attr("y",u).attr("height",u).attr("y",0),d3.select(o).selectAll("g").selectAll(".bar-used").data(c).enter().append("rect").attr("class","bar-used").attr("width",s).attr("x",function(t,e){return s*e+i*e}).attr("y",u).attr("height",0).transition().delay(function(t,e){return 100*e}).attr("y",function(t,e){return u-l(t)}).attr("height",function(t){return l(t)}).attr("fill",function(t,e){return r(t/a[e]*100)})})},o}(jQuery,window);!function(t,e,r,o){"use strict";var n=e.module("pressurizeApp",["ngRoute"]);n.config(["$routeProvider",function(t){t.when("/projects/",{templateUrl:"partials/projects-list.html",controller:"ProjectsListController"}).when("/projects/create/",{templateUrl:"partials/projects-create.html",controller:"ProjectCreateController"}).otherwise({redirectTo:"/projects/"})}]),n.service("sharedProperties",function(){var t=null!==localStorage.getItem("projects")?JSON.parse(localStorage.getItem("projects")):[],e=null!==localStorage.getItem("time_records")?JSON.parse(localStorage.getItem("time_records")):[];return{getProjects:function(){return t=_.filter(t,function(t){return"undefined"!=typeof t.name?t:void 0})},setProjects:function(e){t.push(e),t=_.filter(t,function(t){return"undefined"!=typeof t.name?t:void 0});var r=JSON.stringify(t,function(t,e){return"$$hashKey"==t?void 0:e});localStorage.setItem("projects",r)},updateProjects:function(t){this.setProjects(t)},getTimeRecords:function(){return e=_.filter(e,function(t){return"undefined"!=typeof t.name?t:void 0})},setTimeRecords:function(t){e.push(t),e=_.filter(e,function(t){return"undefined"!=typeof t.hours?t:void 0});var r=JSON.stringify(e,function(t,e){return"$$hashKey"==t?void 0:e});localStorage.setItem("time_records",r)}}}),n.controller("ProjectsListController",["$scope","$http","sharedProperties",function(e,o,n){e.projects=n.getProjects(),e.init=function(){var e=setInterval(function(){t(".chart").length>0&&(r.renderBarCharts(),clearInterval(e))},100)}}]),n.controller("TimeRecordsController",["$scope","$http","sharedProperties","$compile",function(t,e,r,n){t.time_record={},t.timeRecordSubmit=function(e){e||alert("please fill out required fields");var n=new TimeRecord(t.time_record),a=_.findWhere(r.getProjects(),{$$hashKey:t.time_record.project_number});a.total_used=parseInt(a.total_used)+parseInt(n.hours);var c=r.getProjects();c=_.map(function(t){return t.$$hashKey==n.project_number?t:void 0}),r.updateProjects(c),r.setTimeRecords({hours:n.hours,comments:n.comments,project_number:n.project_number}),o.location="/#/projects"}}]),n.controller("ProjectCreateController",["$scope","$http","sharedProperties",function(t,e,r){t.project={},t.submitForm=function(e){e||alert("please fill out all fields correctly"),r.setProjects({name:t.project.name,description:t.project.description,dev_hours:t.project.dev_hours,total_used:t.project.total_used}),alert("project created!"),o.location="/#/projects"}}])}(jQuery,angular,App,window),RowEditor=function(t,e){"use strict";var r=function(t){this.$object=t};return r.prototype.init=function(){this.addEvents($obj)},r}(jQuery,window),TimeRecord=function(t,e){"use strict";var r=function(e){"undefined"!=typeof e.hours&&(e.hours=parseInt(e.hours),this.hours=e.hours,this.project_number=e.project_number,this.comments=t.trim(e.comments))};return r.prototype={hours:0,comments:"",project_number:null},r}(jQuery,window);